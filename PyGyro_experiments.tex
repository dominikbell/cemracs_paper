\subsection{Conservation Properties}

As we saw in the theoretical part of this paper (sec. !!reference missing!!), the mass, the $l^2$-norm, and the energy should be conserved exactly by the poloidal step if the Arakawa scheme is used for the discretization of the Poisson bracket. We can see in fig.\ref{fig:conservation-properties} that the relative error of these quantities is very well given in the linear phase (until $t=$)

\begin{figure}
    \centering
    \includegraphics[width=0.7\linewidth]{plots/conservation properties.png}
    \caption{The relative error of mass, $l^2$-norm, and energy is plotted against time. The parameters for this result were: number of points in $(r, \theta, z, v)$ = (32, 32, 8, 32), time step-size $\Delta t = 8$, and an explicit scheme (Runge-Kutta of order 4) was used.}
    \label{fig:conservation-properties}
\end{figure}

\subsection{Order of Convergence}

In order to find the order of convergence, we run the code multiple times with the same parameters for time but different meshes: A first run is done on a coarse mesh, followed by a run on a mesh with half the grid spacing (in each direction). Then the error between the two in the $l^2$-norm is computed. This procedure is repeated for multiple refinements in the mesh, each time halving the grid spacing and computing the $l^2$-error between the coarse and the finer run. Plotting the errors against the grid spacings yields the curves of fig. \ref{fig:convergence_constadv} and fig. \ref{fig:convergence_vortex}.

The same was done for Dirichlet and period boundary conditions, both for order 2 and 4. A summary can be found in tab. \ref{tab:order-of-convergence}.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.6\linewidth]{plots/convergence_constadv.png}
    \caption{The convergence plot for a constant advection problem for the 4th order Arakawa discretization of the Poisson bracket with extrapolation boundary conditions. The slope of the line is 3.85. This plot was obtained for starting number of points $N_s=20$, time step-size $\Delta t = 0.05$, number of iterations $N_t = 100$.}
    \label{fig:convergence_constadv}
\end{figure}

\begin{figure}[h]
    \centering
    \includegraphics[width=0.6\linewidth]{plots/convergence_vortex.png}
    \caption{The convergence plot for a vortex advection problem for the 4th order Arakawa discretization of the Poisson bracket with extrapolation boundary conditions. The slope of the line is 3.91. This plot was obtained for starting number of points $N_s=20$, time step-size $\Delta t = 0.05$, number of iterations $N_t = 100$.}
    \label{fig:convergence_vortex}
\end{figure}

\begin{table}[h]
    \centering
    \begin{tabular}{c|c|c|c}
        advection problem & boundary conditions & order of scheme & order of convergence \\
        \hline
        constAdv & dirichlet & 2 & 1.3934413454943548 \\
        constAdv & dirichlet & 4 & 3.783103206618439 \\
        constAdv & periodic & 2 & 1.393388070156481 \\
        constAdv & periodic & 4 & 3.7831032066177572 \\
        constAdv & extrapolation & 4 & 3.7831032065920396 \\
        vortex & dirichlet & 2 & 1.6930740420632941 \\
        vortex & dirichlet & 4 & 3.861291237459171 \\
        vortex & periodic & 2 & 1.6930691035059502 \\
        vortex & periodic & 4 & 3.8612912374591724 \\
        vortex & extrapolation & 4 & 3.861291237405154
    \end{tabular}
    \caption{The order of convergence for different boundary conditions and theoretical orders (of construction) for two advection problems (constant and vortex) and the numerical findings of the actual order of convergence. These parameters were obtained for starting number of points $N_s=15$, time step-size $\Delta t = 0.05$, number of iterations $N_t = 50$.}
    \label{tab:order-of-convergence}
\end{table}
