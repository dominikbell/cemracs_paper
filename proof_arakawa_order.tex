% !TeX spellcheck = en_GB


\section{Order of Convergence for the Arakawa Scheme}
\label{sec:ara_order}

In order to calculate the convergence order of the different Finite Difference schemes, we use Mathematica and define the series expansion at every grid-point used in the stencil. Then introducing the discrete Jacobians, that will approximate our Poisson bracket, we combine them to the full Arakawa scheme and look at the appearing orders. The Mathematica input is written in bold font, while the output is following after. \\ 

\noindent\(	\pmb{F[\text{i$\_$}, \text{j$\_$}] = \text{Series}[f[x+i*h,y+j*h], \{h,0, 3\}, \{h,0, 3\}] \ \text{//}\text{Normal};}\\
	\pmb{\Phi[\text{i$\_$}, \text{j$\_$}] = \text{Series}[\varphi[x+i*h,y+j*h], \{h,0, 3\}, \{h,0, 3\}] \ \text{//}\text{Normal};} \)
\textbf{Second order - nine-point-stencil:}\\
%todo fix alignment
\begin{align*}
	\pmb{J^{++} = }
	\pmb{ \frac{1}{4 h^2}}
	&\pmb{( (F[1, 0] - F[-1, 0])*(\Phi[0,1]-\Phi[0,-1]) } \\
	&\pmb{- (F[0,1]-F[0,-1])*(\Phi[1,0]-\Phi[-1,0])) \ \text{//}\text{Simplify}};\\
%
	\pmb{J^{+x} = }
	\pmb{ \frac{1}{4 h^2}}
	&\pmb{( F[1,0]*(\Phi[1,1] - \Phi[1,-1])-F[-1, 0]*(\Phi[-1, 1]- \Phi[-1, -1]) - }\\
	&\pmb{F[0, 1]*(\Phi[1, 1] - \Phi[-1, 1]) + }
	\pmb{F[0, -1]*(\Phi[1, -1]-\Phi[-1,-1])) \ \text{//}\text{Simplify}}; \\
%
	\pmb{J^{x+} = }
	\pmb{ \frac{1}{4 h^2}}
	&\pmb{(F[1,1]*(\Phi[0,1]-\Phi[1,0])-F[-1,-1]*(\Phi[-1,0]-\Phi[0,-1]) }\\
	&-\pmb{F[-1,1]*(\Phi[0,1]-\Phi[-1,0])+F[1,-1]*(\Phi[1,0]-\Phi[0,-1])) \ \text{//}} \pmb{\text{Simplify}};\\
%
	\pmb{ J = \frac{1}{3}} & \pmb{(J^{++} + J^{+x} + J^{x+}) \ \text{//}\text{Simplify}};
\end{align*}
\begin{align*}
&\pmb{	\text{Collect}[J,h] } \ \text{//}\text{Simplify} \\
 &f^{(1,0)}(x,y) \varphi^{(0,1)}(x,y)-f^{(0,1)}(x,y) \varphi^{(1,0)}(x,y) \\
 &+\frac{1}{6} h^2 \left(f^{(1,0)}(x,y) \varphi^{(0,3)}(x,y)+f^{(1,0)}(x,y) \varphi^{(2,1)}(x,y)-f^{(0,3)}(x,y) \varphi^{(1,0)}(x,y) \right.\\
   &+f^{(1,1)}(x,y) \varphi^{(0,2)}(x,y)-f^{(0,2)}(x,y) \varphi^{(1,1)}(x,y)-f^{(0,1)}(x,y) \varphi^{(1,2)}(x,y)+f^{(2,0)}(x,y) \varphi^{(1,1)}(x,y)\\
   &-f^{(1,1)}(x,y) \varphi^{(2,0)}(x,y)-f^{(2,1)}(x,y)\varphi^{(1,0)}(x,y)\\
   &+\left.\left(f^{(1,2)}(x,y)+f^{(3,0)}(x,y)\right) \varphi^{(0,1)}(x,y)-f^{(0,1)}(x,y) \varphi^{(3,0)}(x,y)\right)\\
   &+ \frac{1}{36} h^4 \left(f^{(3,0)}(x,y) \varphi^{(2,1)}(x,y)+\left(f^{(1,2)}(x,y)+f^{(3,0)}(x,y)\right) \varphi^{(0,3)}(x,y) \right.\\
   &-\left.f^{(2,1)}(x,y) \varphi^{(3,0)}(x,y)-f^{(0,3)}(x,y) \left(\varphi^{(1,2)}(x,y)+\varphi^{(3,0)}(x,y)\right)\right)
\end{align*}

\newpage
\textbf{Fourth order - fourteen-point-stencil:}\\
\begin{align*}
\pmb{J^{xx} = \frac{1}{8h^2}} &\pmb{((F[1,1]-F[-1,-1])*(\Phi[-1,1]-\Phi[1,-1])} \\
	&\pmb{-(F[-1,1]-F[1,-1])*(\Phi[1,1]-\Phi	[-1,-1])) \ \text{//}\text{Simplify}}\\
	%
\pmb{J_2^{x+} =  \frac{1}{8h^2}}&\pmb{( F[1,1]*(\Phi[0,2] - \Phi[2, 0]) - F[-1,-1]*(\Phi[-2,0]-\Phi[0,-2])} \\
	&\pmb{-F[-1,1]*(\Phi[0,2]-\Phi[-2,0]) + F[1,-1]*(\Phi[2,0]-\Phi[0,-2])) \ \text{//}\text{Simplify}}\\
%
\pmb{J_2^{+x} =  \frac{1}{8h^2}}&\pmb{( F[2,0]*(\Phi[1,1] - \Phi[1, -1]) - F[-2,-0]*(\Phi[-1,1]-\Phi[-1,-1])}\\
&\pmb{- F[0,2]*(\Phi[1,1]-\Phi[-1,1]) + F[0,-2]*(\Phi[1,-1]-\Phi[-1,-1])) \ \text{//}}
\pmb{\text{Simplify}}\\
%
\pmb{J_2 = \frac{1}{3}}&\pmb{(J^{xx}+J_2^{x+}+J_2^{+x}) \ \text{//}\text{Simplify}}\\
%
\pmb{J' = 2J }&\pmb{-J_2 \text{//}\text{Simplify}}
\end{align*}
\begin{align*}
&\pmb{	\text{Collect}[J',h] } \ \text{//}\text{Simplify} \\
&f^{(1,0)}(x,y) \varphi^{(0,1)}(x,y)-f^{(0,1)}(x,y) \varphi^{(1,0)}(x,y) \\
&+ \frac{1}{36} h^4 \left(\left(3 f^{(1,2)}(x,y)+f^{(3,0)}(x,y)\right)\left(-\varphi^{(0,3)}(x,y)\right) +f^{(0,3)}(x,y) \left(3 \varphi^{(1,2)}(x,y)+\varphi^{(3,0)}(x,y)\right) \right.\\
&+3 \left(f^{(2,1)}(x,y) \varphi^{(1,2)}(x,y)+f^{(2,1)}(x,y) \varphi^{(3,0)}(x,y) - \left. f^{(1,2)}(x,y) \varphi^{(2,1)}(x,y)-f^{(3,0)}(x,y) \varphi^{(2,1)}(x,y)\right)\right)
\end{align*}
